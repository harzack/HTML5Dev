/*
 Copyright 2010 Resonate KT Limited  
*/
jQuery.extend({LL:{filename:"webreports/jquery/rkt/jquery.webreports",getCGI:function(){if(this.cgi==undefined)this.cgi=location.pathname.lastIndexOf("/llisapi.dll")>=0?"llisapi.dll":location.pathname.lastIndexOf("/livelink.exe")>=0?"livelink.exe":location.pathname.lastIndexOf("/cs.exe")>=0?"cs.exe":location.pathname.lastIndexOf("/livelink")>=0?"livelink":location.pathname;return this.cgi},supportPath:function(a,b){this.path==undefined&&$("script").each(function(c,d){if((c=$(d).attr("src"))&&c.match($.LL.filename))$.LL.path=
$(d).attr("src").substr(0,c.search($.LL.filename))});a=a?a+"/":"";a=b?a+b:a;return this.path+a},cgiPath:function(){var a=this.getCGI(),b=location.pathname,c=b.lastIndexOf(a);return b.substring(0,c+a.length)},objAction:function(a,b,c){c=$.extend(c,{func:"ll",objAction:a,objId:b});$.get(this.cgiPath(),c.callback,c.type)},RunReport:function(a,b){this.objAction("RunReport",a,b)},icon:function(a,b){switch(a){case 0:return this.supportPath("webdoc","folder.gif");case 136:return this.supportPath("webdoc",
"cd.gif");case 140:return this.supportPath("webdoc","url.gif");case 141:return this.supportPath("webdoc","icon_library.gif");case 142:return this.supportPath("webdoc","icon_mystuff.gif");case 144:if(b)switch(b){case "application/pdf":return this.supportPath("webdoc","apppdf.gif");case "application/msword":return this.supportPath("webdoc","appword.gif");case "application/vnd.ms-excel":return this.supportPath("webdoc","appexel.gif");case "image/jpeg":return this.supportPath("webdoc","appjpeg.gif");
case "application/zip":return this.supportPath("webdoc","appzip.gif");case "text/html":return this.supportPath("webdoc","appiexpl.gif");default:return this.supportPath("webdoc","doc.gif")}else return this.supportPath("webdoc","doc.gif");case 299:return this.supportPath("report","16report.gif");case 3030202:return this.supportPath("spdcommittee","16committee.gif");default:return this.supportPath("webdoc","llroot.gif")}},lapi:function(a,b,c,d){if($.isFunction(b)){d=c;c=b;b={}}d=$.extend({global:true},
d);var e={func:"webreports.lapi",lapi:a,inArgs:$.json.encode(b)};this.queueAjax(function(){$.ajax({type:"POST",url:$.LL.cgiPath(),data:e,success:c,dataType:"json",global:d.global})})},invokeservice:function(a,b,c,d){if($.isFunction(c)){d=c;c={}}$.LL.lapi("InvokeService",{ServiceName:a,ServiceMethod:b,Arguments:c},d)},setMaxActive:function(a){this.maxActive=a},queueAjax:function(a){this.queue=this.queue||[];this.queue.push(a);this.fireAjax()},fireAjax:function(){this.queue=this.queue||[];for(this.maxActive=
this.maxActive||50;$.active<=this.maxActive&&0<this.queue.length;)this.queue.shift()()}}});$(window).ajaxComplete(function(){jQuery.LL.fireAjax()});jQuery.extend({WR:{llrequest:"webreports.runservice",invoke:function(a,b,c,d){if($.isFunction(b)){d=c;c=b;b=""}d=d?d:"text";var e={func:this.llrequest,servicetype:"gettagdata",tagdata:a,statictag:a,subtags:b,responsetype:$.inArray(d,["json","xml"])>-1?d:"string"};$.LL.queueAjax(function(){$.post($.LL.cgiPath(),e,c,d)})}}});
jQuery.extend({AV:{llrequest:"activeview.runservice",invoke:$.WR.invoke}});
jQuery.extend({MultiButton:{defaultButtons:{move:["move","Move","ll.ProcessMultiMove","move"],copy:["copy","Copy","ll.ProcessMultiCopy","copy"],del:["del","Delete","ll.ProcessMultiDelete","delete"],zipdwnld:["multifile/zipdwnld","Zip & Download","multifile.zipdwnldmulti","zipdwnld"],zipemail:["multifile/zipemail","Zip & E-mail","multifile.zipemailmulti","zipemail"],print:["multifile/print","Print","multifile.printmulti","print"],collect:["collections/collect","Collect","ll.CollectStaging","collectItems"]},
makeButton:function(a,b,c,d){var e=$.tmpl("url(#{support}#{img}.gif)",{support:$.LL.supportPath(),img:a}),f=$.tmpl("url(#{support}#{img}2.gif)",{support:$.LL.supportPath(),img:a});return $("<input>").addClass("multiButton").css("background-image",e).hover(function(){$(this).css("background-image",f)},function(){$(this).css("background-image",e)}).attr("name",b).attr("type","button").data("action",c).data("typeStr",d).val(b)},defaultButton:function(a){if(a=this.defaultButtons[a])return this.makeButton(a[0],
a[1],a[2],a[3])},defaultButtonInert:function(a){alert("defaultButtonInert Called");if(a=this.defaultButtons[a])return this.makeButton(a[0],a[1])}}});
jQuery.extend({addJS:function(a){$("<script><\/script>").attr("src",$.LL.supportPath()+a).appendTo("body")},getURLParam:function(a,b){var c=String(document.location).toLowerCase();return $.toQueryParams(c)[a.toLowerCase()]||b},getURLQuery:function(a){a=a||String(document.location);return a.substring(a.indexOf("?")+1).split("#")[0]},getNextURL:function(){return encodeURIComponent(location.pathname+"?"+$.getURLQuery())},toQueryParams:function(a){a=a||String(document.location);a=a.substring(a.indexOf("?")+
1).split("#")[0].split("&");for(var b={},c,d,e=0;e<a.length;e++){d=a[e].split("=");c=decodeURIComponent(d[0]);d=d[1]?decodeURIComponent(d[1]):undefined;if(b[c]){if(typeof b[c]=="string")b[c]=[b[c]];b[c].push(d)}else b[c]=d}return b},quote:function(a,b){b=b||'"';return b+a+b},isInteger:function(a){return a.toString().search(/^-?[0-9]+$/)==0},tmpl:function(a,b){return a.replace(/#{([^{}]*)}/g,function(c,d){d=b[d];return typeof d==="string"||typeof d==="number"?d:c})},cleanString:function(a){return $.trim(a).replace(/ /g,
"_").toLowerCase()},generateGuid:function(){return $.S4()+$.S4()+"-"+$.S4()+"-"+$.S4()+"-"+$.S4()+"-"+$.S4()+$.S4()+$.S4()},S4:function(){return((1+Math.random())*65536|0).toString(16).substring(1)}});jQuery.extend({attrTypes:{CheckboxType:5,DateFieldType:-7,DatePopupType:13,IntegerFieldType:2,IntegerPopupType:12,RealFieldType:-4,SetType:-18,TextFieldType:-1,TextMultiLineType:11,TextPopupType:10,UserFieldType:14}});
jQuery.attrTypes=jQuery.extend(jQuery.attrTypes,{stringTypes:[$.attrTypes.TextFieldType,$.attrTypes.TextMultiLineType,$.attrTypes.TextPopupType],integerTypes:[$.attrTypes.IntegerFieldType,$.attrTypes.IntegerPopupType],booleanTypes:[$.attrTypes.CheckboxType],dateTypes:[$.attrTypes.DateFieldType,$.attrTypes.DatePopupType],popupTypes:[$.attrTypes.TextPopupType,$.attrTypes.IntegerPopupType,$.attrTypes.DatePopupType]});
jQuery.fn.extend({outerHTML:function(){return $("<div>").append(this.eq(0).clone()).html()},stripTags:function(){return this.html().replace(/<\/?[^>]+>/gi,"")},pluck:function(a){var b=[];this.each(function(){b.push(this[a])});return b},guid:function(){return this.each(function(){$(this).attr("id").length==0&&$(this).attr("id",$.generateGuid())})},decodeDataIsland:function(){var a=this[0];if(a)return $.json.decode(a.firstChild.data);return[]}});
$LL=function(a){if(this.nodes==undefined)this.nodes={};if(this.nodes[a]==undefined)this.nodes[a]=new $LL.fn.init(a);return this.nodes[a]};
$LL.fn={init:function(a){this.dataid=a},rename:function(a,b){this.UpdateObjectInfo("Name",a,b);return this},UpdateObjectInfo:function(a,b,c){var d={};d[a]=b;$.LL.lapi("UpdateObjectInfo",{VolumeID:0,NodeID:this.dataid,ObjInfo:d},c);return this},GetObjectInfo:function(a){$.LL.lapi("GetObjectInfo",{VolumeID:0,NodeID:this.dataid},a);return this},FetchCategoryVersion:function(a){$.LL.lapi("FetchCategoryVersion",{catID:{ID:this.dataid}},a);return this}};$LL.fn.init.prototype=$LL.fn;
String.prototype.beginsWith=function(a){return this.match("^"+a)==a};String.prototype.endsWith=function(a){return this.match(a+"$")==a};String.prototype.stripTags=function(){return this.replace(/<\/?[^>]+>/gi,"")};String.prototype.escapeHTML=function(){var a=document.createElement("div");a.appendChild(document.createTextNode(this));return a.innerHTML};String.prototype.unescapeHTML=function(){var a=document.createElement("div");a.innerHTML=this.stripTags();return a.childNodes[0].nodeValue};
$.extend(Date.prototype,{fromLLDate:function(a){this.setTime(Date.parse(a.substr(2).replace(":"," ")))},toLLDate:function(){var a=this.getFullYear(),b=this.getMonth()+1,c=this.getDate(),d=this.getHours(),e=this.getMinutes(),f=this.getSeconds();return"D/"+a+"/"+b+"/"+c+":"+d+":"+e+":"+f},isValid:function(){return!isNaN(this.getTime())}});$(function(){if(window.BrowseViewColumn&&BrowseViewColumn.prototype.addProperty)BrowseViewColumn.prototype.addProperty=Object.prototype.addProperty;delete Object.prototype.addProperty});
