<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<META bookrevnum="LLESWFM100500-H-UGD-EN">
<META PiXprocLocator="webform">
<META mancondkey="llesfrm-h-ugd"><title>To Include a JavaScript Submission Button</title>
<META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.44">
<META NAME="SECTLVL" CONTENT="2">
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../../ix21.css">

<script language="JavaScript" src="../../llhelp.js"></script>
</HEAD>
<body ONLOAD="checkFrame( 'hf-jsbtn-p.htm' )" CLASS="Body" TEXT="#000000" BGCOLOR="#FFFFFF" link="#003366" alink="#3300FF" vlink="#660033" background="../../images/pattern.gif">

<DIV ID="HL4SRCH">
<DIV CLASS="PAGECONTENT" ID="PAGECONTENT">
<!-- header -->
  <script language="JavaScript">
          var header = new AdminHeader("../../images/");
          header.title1 = 'Adding an HTML File as a View';
          header.title2 = 'To Include a JavaScript Submission Button';
           header.draw();
  </script>
  <A NAME="INCLUDEJS"></A>
<DIV title="To include a JavaScript submission button:" CLASS="PROCEDURE">
<P><B>To include a JavaScript submission button:</B></P>
<OL TYPE="1">
<LI>
<P class="nr1"><A NAME="TMPID125"></A>Export the Form as HTML.</P></LI>
<LI>
<P class="nr1"><A NAME="TMPID127"></A>Open the Form in an HTML editor.</P></LI>
<LI>
<P class="nr1"><A NAME="TMPID129"></A>Add HTML code to create a button for users to click in order to run the JavaScript submission mechanism. For example: 
<PRE 
CLASS="SCREEN"
><A NAME="AEN129"></A>&lt;INPUT TYPE= "BUTTON" VALUE="Submit" ONCLICK= "SubmitNow();"&gt;</PRE
></P></LI>
<LI>
<P class="nr1"><A NAME="TMPID132"></A>Type your script similar to the following:</P>
<P>
<PRE 
CLASS="SCREEN"
><A NAME="TMPID133"></A><A NAME="AEN133"></A>function SubmitNow()</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN134"></A>{var llfv = document.myForm.LL_FUNC_VALUES.value;</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN135"></A>if ( llfv.substring( 0, 14 ) != "A&lt;1,?,'func'='" )</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN136"></A>{alert( "llfuncvalues is not an assoc???" );}</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN137"></A>else{if ( llfv.substring( 14, 27 ) != "Form.SaveForm" )</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN138"></A>{alert( "llfuncvalues is not saving???" );}</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN139"></A>else{var old = llfv;</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN140"></A>// change the function from Form.SaveForm to Form.SubmitForm</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN141"></A>llfv = "A&lt;1,?,'func'='Form.SubmitForm'" + old.substring( 28, old.length );</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN142"></A>// save this back to llfuncvalues</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN143"></A>document.myForm.LL_FUNC_VALUES.value = llfv;//alert(llfv);}}</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN144"></A>// submit the form</PRE
>
<PRE 
CLASS="SCREEN"
><A NAME="AEN145"></A>document.myForm.submit( "contentserver.exe#FDF", false, true );}</PRE
></P></LI>
<LI>
<P class="nr1"><A NAME="TMPID148"></A>Save the Form.</P></LI></OL></DIV>
<P class="nr1"><A NAME="TMPID149"></A>For information related to this procedure, see <span><A HREF="hf-add-view-bg.htm">Adding an HTML File as a View</A></span>.</P>
<P ALIGN="RIGHT"></P></DIV></DIV>

  <script language="JavaScript">
       new AdminFooter("../../images/").draw();
  </script>
</body></HTML>